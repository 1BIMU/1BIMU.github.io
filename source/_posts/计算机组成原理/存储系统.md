---
title: 存储系统
date: 2025-05-03 08:00:41
categories:
  - 计算机
tags:
  - 计算机组成原理
mathjax: true
---

# 存储器的分类  
1、易失性半导体称为RAM  
2、非易失性半导体称为ROM  
可以粗略的这样理解，RAM一般用来做内存，ROM一般用来做外存（不绝对）  

# 存储器的性能指标  
1、存储容量：一般按照存储字数×字长的格式表示  
2、单位成本：位价 = 总成本/总容量  
3、存储速度：数据宽度/存取周期  
存取周期指进行一次完整的读写操作所需的全部时间  

# 存储器的多层级系统  
为了解决存储系统大容量、高速度和低成本的三个相互制约的矛盾，在计算机系统中，常常采取多级存储器的结构，如下所示  
![图片描述](/IMG/Pasted%20image%2020250423145833.png)  
存储器多层级系统的核心思想是**上一层的存储器作为低一层存储器的高速缓存**  
其中，主存和cache之间的调度是由硬件自动完成，对所有程序员透明  
主存和磁盘之间的调度由操作系统和硬件共同完成，对应用程序员透明  

同时，我们还可以使用并行计算的技术，每次存取多个字，同时计算/处理多个字来加速运算。  

# CPU和存储器的链接模型  
总体而言，可以概括为下图  
![图片描述](/IMG/Pasted%20image%2020250423155106.png)  
CPU通过地址总线和读写信号控制主存，主存通过数据总线和准备信号返回给CPU  
![图片描述](/IMG/Pasted%20image%2020250423155153.png)![图片描述](/IMG/Pasted%20image%2020250423155200.png)  

# SRAM存储器  
![图片描述](/IMG/Pasted%20image%2020250423160052.png)  
以上为SRAM的存储结构。对于地址，这里的X译码器和Y译码器分别对行和列进行译码，额外还有一个译码器进行片选，这里没有画出来。  
这里看到的存储矩阵一共有16片，这16片分别代表数据的16位。也就是说，这是一个16位的机器。  

## 存储器的容量扩充（重点）  
一片存储器的容量是有限的，使用多片存储器芯片才能构造一个具有一定容量和字长的存储器。个人理解，存储器这部分没啥好考的，就这里最重要，所以一定要注意。  

### 位拓展法  
是更充分的利用数据总线的一种方式。在不增加任何地址线的基础上，多增加的存储器并联到数据总线上，实现位的增加。简单来说，本来有8K×8位的一个存储器，经过位拓展后，变为了8K×16位的存储器。![图片描述](/IMG/Pasted%20image%2020250423162006.png)  
不过，需要注意这种拓展方法的上限和数据线的宽度有关。  

### 字拓展法  
是纵向的对于存储器的一种堆叠。但是需要利用更多的地址线。我们利用更多的地址线进行片选存储，是单纯的存储数据的扩展。![图片描述](/IMG/Pasted%20image%2020250423162946.png)  

### 字位同时拓展法  
字位同时拓展可以理解为，先对存储器进行位拓展，然后把拓展后的存储器作为一个单元，对这个单元进行字拓展。![图片描述](/IMG/Pasted%20image%2020250423163048.png)  

## SRAM时序  
![图片描述](/IMG/Pasted%20image%2020250423171218.png)  
![图片描述](/IMG/Pasted%20image%2020250423171225.png)  

### SRAM读周期与写周期综合说明  

#### 1. 读周期（Read Cycle）  
**功能**：从指定地址读取数据并输出到I/O端口。  

##### 关键参数  
- **读出时间 $t_{AQ}$**  
  从地址有效到数据稳定输出在I/O端口所需的时间。  
- **读周期时间 $t_{RC}$**  
  两次连续读操作之间必须满足的最小间隔时间，确保存储器完成内部操作（如预充电）。  

##### 时序过程  
1. **地址输入**  
   提供有效地址信号，指定要读取的存储单元。  
2. **片选与输出使能**  
   - 片选信号 $\overline{CS}$ 为低电平，选中SRAM芯片。  
   - 输出使能信号 $\overline{OE}$ 为低电平，允许数据输出。  
3. **数据输出**  
   - 地址译码后，选中存储单元，数据通过位线传输。  
   - 经过 $t_{AQ}$ 时间后，数据稳定输出到I/O端口。  
4. **读周期结束**  
   在 $t_{RC}$ 时间后，可开始下一次读操作。  

##### **控制信号**  
- **$\overline{CS}$（片选信号）**：选中SRAM芯片。  
- **$\overline{OE}$（输出使能信号）**：使能数据输出路径。  

#### 2. 写周期（Write Cycle）  
**功能**：将数据写入指定地址的存储单元。  

##### **关键参数**  
- **写周期时间 $t_{WC}$**  
  完成一次写操作所需的总时间。  
- **地址建立时间 $t_{SA}$**  
  在 $\overline{WE}$ 有效前，地址信号必须保持稳定的时间。  
- **写数据有效时间 $t_{WD}$**  
  在 $\overline{WE}$ 有效后，输入数据必须保持有效的时间。  
- **数据保持时间 $t_{hD}$**  
  在 $\overline{WE}$ 恢复高电平后，数据仍需保持不变的时间。  

##### **时序过程**  
1. **地址输入**  
   提供有效地址信号，指定要写入的存储单元。  
2. **片选与写使能**  
   - 片选信号 $\overline{CS}$ 为低电平，选中SRAM芯片。  
   - 写使能信号 $\overline{WE}$ 为低电平，允许数据写入。  
3. **数据输入与写入**  
   - 输入数据必须在 $\overline{WE}$ 有效后 $t_{WD}$ 时间内保持稳定。  
   - 数据通过I/O端口写入选中的存储单元。  
4. **写周期结束**  
   在 $t_{WC}$ 时间后，写操作完成，可进行下一次操作。  

##### **控制信号**  
- **$\overline{CS}$（片选信号）**：选中SRAM芯片。  
- **$\overline{WE}$（写使能信号）**：使能数据写入路径。  

#### **3. 对比与总结**  
| **参数/过程**       | **读周期（Read）**                | **写周期（Write）**                |  
|---------------------|----------------------------------|----------------------------------|  
| **核心功能**         | 从存储单元读取数据                | 将数据写入存储单元                |  
| **关键信号**         | $\overline{CS}$、$\overline{OE}$ | $\overline{CS}$、$\overline{WE}$ |  
| **关键时间参数**     | $t_{AQ}$、$t_{RC}$               | $t_{WC}$、$t_{SA}$、$t_{WD}$、$t_{hD}$ |  
| **数据流向**         | 存储单元 → I/O端口               | I/O端口 → 存储单元               |  
| **时序约束**         | 确保数据稳定输出（$t_{AQ}$）      | 确保地址和数据有效时间（$t_{SA}$、$t_{WD}$） |  

#### 4. 注意事项  
1. **时序匹配**  
   - 系统设计需满足 $t_{RC}$ 和 $t_{WC}$ 的约束，避免操作冲突。  
   - 写操作需确保地址和数据在 $t_{SA}$ 和 $t_{WD}$ 内稳定。  
2. **信号时序**  
   - $\overline{OE}$ 和 $\overline{WE}$ 的时序需与地址、数据信号严格配合。  
3. **数据稳定性**  
   - 读周期中，数据在 $t_{AQ}$ 时间前可能处于**高阻态（High-Z）** 或 **过渡状态**（时序图中显示为黑色区域）。  
   - 写周期中，数据需在 $\overline{WE}$ 有效期间保持稳定，否则可能导致写入错误。  

# DRAM存储器  

## 特点  
DRAM相比于SRAM来说，具有密度高，位价低，和功耗小的优点，但是DRAM的读取速度相对较慢，并且是破坏性读出，因此必须定时刷新和读后再生。  

## 刷新方式  
首先，刷新基本上只能以存储器的行为单位，并且，我们将对同一行进行相邻两次刷新的时间间隔称为$\text{刷新周期}$，通常取2ms  
1) 集中刷新  在一个刷新周期内，利用一段固定的时间，集中对所有存储器的所有行进行逐一再生，在此期间暂停读/写操作，称为死时间。  
2) 分散刷新 把读写操作和刷新周期合成一个工作周期，前半部分分配给读写操作，后半部分分配给刷新操作。这样就没有死区了。  
3) 异步刷新 使得一个刷新周期内，每一行只刷新一次。具体来说，就是把每一行的刷新的时间分开，将刷新周期除以行数，得到相邻两行之间刷新的时间间隔t，每隔t时间，产生一次刷新请求，这就使死时间更为分散。  

## 读取时序  
![](/IMG/Pasted%20image%2020250522165804.png)  
![](/IMG/Pasted%20image%2020250522165817.png)  
其中，RAS指的是行选通信号，CAS是列选通信号  

## 引脚复用技术  
由于DRAM芯片容量很大，地址位数较多，为了减少芯片的地址引脚数，我们复用行地址和列地址的输入引脚，分两次不同按照不同的时序输入。  
![对比](/IMG/Pasted%20image%2020250522164521.png)  

# ROM存储器  
- PROM：一次编程只读存储器。  
出厂时全为0，用户可选择把一些内容改为1。  
- 多次编程只读存储器：主要讲了UV-EPROM和EEPROM，比起PROM增加了擦除能力  
- 闪存存储器：相比EPROM，Flash Memory在擦除过程更加的迅速和便捷，最早的东芝的NAND闪存只支持按页存取数据，故无法直接替代传统ROM芯片。但是后来，Intel退出了NOR闪存，读取很快，但是写入时间较长。可以直接替换EPROM。  
![图片描述](/IMG/Pasted%20image%2020250423175018.png)  

# 并行存储器  

## 双端口存储器DPRAM  
结构如下所示  
![图片描述](/IMG/Pasted%20image%2020250423175328.png)  
但是这种并行的存储会造成冲突。显然，当两边同时对同一存储单元进行写入的时候，会造成读写冲突。为了解决这个冲突，我们设计了$\overline{BUSY}$线。  
$\overline{BUSY}$线的运行逻辑如下：  
1、判断逻辑部件决定哪个端口优先读写  
2、将另一侧的$\overline{BUSY}$线设为0，表示延迟执行  
所以重点在判断逻辑部件上  
判断逻辑分为两种  
当地址匹配先于CE#冲突时，采用CE仲裁  
当CE#先为有效位的时候，采用地址仲裁  

# 多模块存储器  

## 核心技术原理  
多模块存储器本质上采取的是一种空间并行技术，利用多个结构完全相同的存储模块的并行工作来提高存储器的吞吐率。  

## 单体多字存储器  
在单体多字系统中，主要拓宽的就是存储器的存储字长，每个存储单元存储m个字，总线宽度也为m个字，一次并行读出m个字，在一个存取周期内，从同一地址取出m条指令，然后将指令逐条送到CPU执行。  
缺点：只有连续存放时，一次并行读出的数据才会是有效的指令，否则后面读出的都无效了  

## 多体并行存储器  
由多个模块组成，每个模块有相同的容量和存取速度，方便并行工作。  

### 高位交叉编址  
跟直接拓展存储器差不多，就是对高位地址改为片选，低位地址为存储器内部选数据使用  
![](/IMG/Pasted%20image%2020250522171256.png)  

### 低位交叉编址  
跟高位相反，此时低位地址为模块的片选。  
![](/IMG/Pasted%20image%2020250522171751.png)  

### 计算存取时间和带宽  
连续取m个字的时间：$$  
t_1 = T+(m-1)r  
$$其中，r为总线的传输周期，T为存取周期，模块数为m  